<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  


  <head>
    <title>
      TracReports – Kahina
    </title>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!--[if IE]><script type="text/javascript">
      if (/^#__msie303:/.test(window.location.hash))
        window.location.replace(window.location.hash.replace(/^#__msie303:/, '#'));
    </script><![endif]-->
        <link rel="search" href="../search.html" />
        <link rel="help" href="TracGuide.html" />
        <link rel="alternate" href="http://kahina.org/trac/wiki/TracReports?format=txt" type="text/x-trac-wiki" title="Plain Text" />
        <link rel="start" href="../wiki.html" />
        <link rel="stylesheet" href="../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../chrome/common/css/wiki.css" type="text/css" />
        <link rel="shortcut icon" href="../chrome/common/trac.ico" type="image/x-icon" />
        <link rel="icon" href="../chrome/common/trac.ico" type="image/x-icon" />
    <style id="trac-noscript" type="text/css">.trac-noscript { display: none !important }</style>
      <link type="application/opensearchdescription+xml" rel="search" href="../search/opensearch" title="Search Kahina" />
      <script type="text/javascript" charset="utf-8" src="../chrome/common/js/jquery.js"></script>
      <script type="text/javascript" charset="utf-8" src="../chrome/common/js/babel.js"></script>
      <script type="text/javascript" charset="utf-8" src="../chrome/common/js/trac.js"></script>
      <script type="text/javascript" charset="utf-8" src="../chrome/common/js/search.js"></script>
      <script type="text/javascript" charset="utf-8" src="../chrome/common/js/folding.js"></script>
    <script type="text/javascript">
      jQuery("#trac-noscript").remove();
      jQuery(document).ready(function($) {
        $(".trac-autofocus").focus();
        $(".trac-target-new").attr("target", "_blank");
        setTimeout(function() { $(".trac-scroll").scrollToTop() }, 1);
        $(".trac-disable-on-submit").disableOnSubmit();
      });
    </script>
    <meta name="ROBOTS" content="NOINDEX, NOFOLLOW" />
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("#content").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $("#content").find(".wikianchor").each(function() {
          $(this).addAnchor(babel.format(_("Link to #%(id)s"), {id: $(this).attr('id')}));
        });
        $(".foldable").enableFolding(true, true);
      });
    </script>
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="../../index.html"><img src="../chrome/site/kahina-logo.png" alt="Kahina" height="68" width="195" /></a>
      </div>
      <form id="search" action="../search.html" method="get">
        <div>
          <label for="proj-search">Search:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Search" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="http://kahina.org/trac/login">Login</a></li><li><a href="TracGuide.html">Help/Guide</a></li><li><a href="../about.html">About Trac</a></li><li class="last"><a href="../prefs.html">Preferences</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first active"><a href="../wiki.html">Wiki</a></li><li><a href="../timeline.html">Timeline</a></li><li><a href="../roadmap.html">Roadmap</a></li><li><a href="../report.html">View Tickets</a></li><li class="last"><a href="../search.html">Search</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="pagepath" class="noprint">
  <a class="pathentry first" title="View WikiStart" href="../wiki.html">wiki:</a><a class="pathentry" href="TracReports.html" title="View TracReports">TracReports</a>
</div>
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
        <ul>
          <li class="first"><a href="WikiStart.html">Start Page</a></li><li><a href="TitleIndex.html">Index</a></li><li class="last"><a href="http://kahina.org/trac/wiki/TracReports?action=history">History</a></li>
        </ul>
        <hr />
      </div>
    <div id="content" class="wiki">
      <div class="wikipage searchable">
        
          <div id="wikipage" class="trac-content"><h1 id="TracReports">Trac Reports</h1>
<p>
</p><div class="wiki-toc"><h4>Table of Contents</h4><ul><li class="False"><a class="False" href="TracGuide.html">Index</a></li><li class="False"><a class="False" href="http://kahina.org/trac/wiki/TracInstall">Installation</a></li><li class="False"><a class="False" href="http://kahina.org/trac/wiki/TracInterfaceCustomization">Customization</a></li><li class="False"><a class="False" href="http://kahina.org/trac/wiki/TracPlugins">Plugins</a></li><li class="False"><a class="False" href="http://kahina.org/trac/wiki/TracUpgrade">Upgrading</a></li><li class="False"><a class="False" href="http://kahina.org/trac/wiki/TracIni">Configuration</a></li><li class="False"><a class="False" href="http://kahina.org/trac/wiki/TracAdmin">Administration</a></li><li class="False"><a class="False" href="http://kahina.org/trac/wiki/TracBackup">Backup</a></li><li class="False"><a class="False" href="http://kahina.org/trac/wiki/TracLogging">Logging</a></li><li class="False"><a class="False" href="http://kahina.org/trac/wiki/TracPermissions">Permissions</a></li><li class="False"><a class="False" href="http://kahina.org/trac/wiki/TracWiki">The Wiki</a></li><li class="False"><a class="False" href="http://kahina.org/trac/wiki/WikiFormatting">Wiki Formatting</a></li><li class="False"><a class="False" href="TracTimeline.html">Timeline</a></li><li class="False"><a class="False" href="http://kahina.org/trac/wiki/TracBrowser">Repository Browser</a></li><li class="False"><a class="False" href="http://kahina.org/trac/wiki/TracRevisionLog">Revision Log</a></li><li class="False"><a class="False" href="http://kahina.org/trac/wiki/TracChangeset">Changesets</a></li><li class="False"><a class="False" href="TracTickets.html">Tickets</a></li><li class="False"><a class="False" href="http://kahina.org/trac/wiki/TracWorkflow">Workflow</a></li><li class="False"><a class="False" href="TracRoadmap.html">Roadmap</a></li><li class="False"><a class="False" href="TracQuery.html">Ticket Queries</a></li><li class="False"><a class="False" href="http://kahina.org/trac/wiki/TracBatchModify">Batch Modify</a></li><li class="active"><a class="False" href="TracReports.html">Reports</a></li><li class="False"><a class="False" href="http://kahina.org/trac/wiki/TracRss">RSS Support</a></li><li class="False"><a class="False" href="http://kahina.org/trac/wiki/TracNotification">Notification</a></li></ul></div><p>
</p>
<p>
The Trac reports module provides a simple, yet powerful reporting facility to present information about tickets in the Trac database.
</p>
<p>
Rather than have its own report definition format, <a class="wiki" href="TracReports.html">TracReports</a> relies on standard SQL <tt>SELECT</tt> statements for custom report definition. 
</p>
<blockquote>
<p>
<strong>Note:</strong> The report module is being phased out in its current form because it seriously limits the ability of the Trac team to make adjustments to the underlying database schema. We believe that the <a class="wiki" href="TracQuery.html">query module</a> is a good replacement that provides more flexibility and better usability. While there are certain reports that cannot yet be handled by the query module, we intend to further enhance it so that at some point the reports module can be completely removed. This also means that there will be no major enhancements to the report module anymore.
</p>
</blockquote>
<blockquote>
<p>
You can already completely replace the reports module by the query module simply by disabling the former in <a class="wiki" href="http://kahina.org/trac/wiki/TracIni">trac.ini</a>:
</p>
<div class="code"><pre><span class="k">[components]</span>
<span class="na">trac.ticket.report.*</span> <span class="o">=</span> <span class="s">disabled</span>
</pre></div><p>
This will make the query module the default handler for the “View Tickets” navigation item. We encourage you to try this configuration and report back what kind of features of reports you are missing, if any.
</p>
</blockquote>
<p>
A report consists of these basic parts:
</p>
<ul><li><strong>ID</strong> — Unique (sequential) identifier 
</li><li><strong>Title</strong> — Descriptive title
</li><li><strong>Description</strong> — A brief description of the report, in <a class="wiki" href="http://kahina.org/trac/wiki/WikiFormatting">WikiFormatting</a> text.
</li><li><strong>Report Body</strong> — List of results from report query, formatted according to the methods described below.
</li><li><strong>Footer</strong> — Links to alternative download formats for this report.
</li></ul><h2 id="ChangingSortOrder">Changing Sort Order</h2>
<p>
Simple reports - ungrouped reports to be specific - can be changed to be sorted by any column simply by clicking the column header. 
</p>
<p>
If a column header is a hyperlink (red), click the column you would like to sort by. Clicking the same header again reverses the order.
</p>
<h2 id="ChangingReportNumbering">Changing Report Numbering</h2>
<p>
There may be instances where you need to change the ID of the report, perhaps to organize the reports better. At present this requires changes to the trac database. The <em>report</em> table has the following schema:
</p>
<ul><li>id integer PRIMARY KEY
</li><li>author text
</li><li>title text
</li><li>query text
</li><li>description text
</li></ul><p>
Changing the ID changes the shown order and number in the <em>Available Reports</em> list and the report's perma-link. This is done by running something like:
</p>
<div class="code"><pre><span class="k">UPDATE</span> report <span class="k">SET</span> id <span class="o">=</span> <span class="mi">5</span> <span class="k">WHERE</span> id <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
</pre></div><p>
Keep in mind that the integrity has to be maintained, ie ID has to be unique, and you don't want to exceed the max, since that's managed by SQLite someplace.
</p>
<p>
You may also need to update or remove the report number stored in the report or query.
</p>
<h2 id="NavigatingTickets">Navigating Tickets</h2>
<p>
Clicking on one of the report results will take you to that ticket. You can navigate through the results by clicking the <em>Next Ticket</em> or <em>Previous Ticket</em> links just below the main menu bar, or click the <em>Back to Report</em> link to return to the report page.
</p>
<p>
You can safely edit any of the tickets and continue to navigate through the results using the <em>Next/Previous/Back to Report</em> links after saving your results, but when you return to the report, there will be no hint about what has changed, as would happen if you were navigating a list of tickets obtained from a query (see <a class="wiki" href="TracQuery.html#NavigatingTickets">TracQuery#NavigatingTickets</a>).
</p>
<h2 id="AlternativeDownloadFormats">Alternative Download Formats</h2>
<p>
Aside from the default HTML view, reports can also be exported in a number of alternative formats.
At the bottom of the report page, you will find a list of available data formats. Click the desired link to 
download the alternative report format.
</p>
<h3 id="Comma-delimited-CSVCommaSeparatedValues">Comma-delimited - CSV (Comma Separated Values)</h3>
<p>
Export the report as plain text, each row on its own line, columns separated by a single comma (',').
<strong>Note:</strong> The output is fully escaped so carriage returns, line feeds, and commas will be preserved in the output.
</p>
<h3 id="Tab-delimited">Tab-delimited</h3>
<p>
Like above, but uses tabs (\t) instead of comma.
</p>
<h3 id="RSS-XMLContentSyndication">RSS - XML Content Syndication</h3>
<p>
All reports support syndication using XML/RSS 2.0. To subscribe to an RSS feed, click the orange 'XML' icon at the bottom of the page. See <a class="wiki" href="http://kahina.org/trac/wiki/TracRss">TracRss</a> for general information on RSS support in Trac.
</p>
<h2 id="CreatingCustomReports">Creating Custom Reports</h2>
<p>
Creating a custom report requires a comfortable knowledge of SQL.
</p>
<p>
Note that you need to set up <a class="wiki" href="http://kahina.org/trac/wiki/TracPermissions#Reports">permissions</a> in order to see the buttons for adding or editing reports.
</p>
<p>
A report is basically a single named SQL query, executed and presented by Trac. Reports can be viewed and created from a custom SQL expression directly in the web interface.
</p>
<p>
Typically, a report consists of a SELECT-expression from the 'ticket' table, using the available columns and sorting the way you want it.
</p>
<h2 id="Ticketcolumns">Ticket columns</h2>
<p>
The <em>ticket</em> table has the following columns:
</p>
<ul><li>id
</li><li>type
</li><li>time
</li><li>changetime
</li><li>component
</li><li>severity  
</li><li>priority 
</li><li>owner
</li><li>reporter
</li><li>cc
</li><li>version
</li><li>milestone
</li><li>status
</li><li>resolution
</li><li>summary
</li><li>description
</li><li>keywords
</li></ul><p>
See <a class="wiki" href="TracTickets.html">TracTickets</a> for a detailed description of the column fields.
</p>
<p>
Example: <strong>All active tickets, sorted by priority and time</strong>
</p>
<div class="code"><pre><span class="k">SELECT</span> id <span class="k">AS</span> ticket<span class="p">,</span> status<span class="p">,</span> severity<span class="p">,</span> priority<span class="p">,</span> <span class="k">owner</span><span class="p">,</span> time <span class="k">AS</span> created<span class="p">,</span> summary 
<span class="k">FROM</span> ticket 
<span class="k">WHERE</span> status <span class="k">IN</span> <span class="p">(</span><span class="s1">'new'</span><span class="p">,</span> <span class="s1">'assigned'</span><span class="p">,</span> <span class="s1">'reopened'</span><span class="p">)</span>
<span class="k">ORDER</span> <span class="k">BY</span> priority<span class="p">,</span> time
</pre></div><h2 id="AdvancedReports:DynamicVariables">Advanced Reports: Dynamic Variables</h2>
<p>
For more flexible reports, Trac supports the use of <em>dynamic variables</em> in report SQL statements. 
In short, dynamic variables are <em>special</em> strings that are replaced by custom data before query execution.
</p>
<h3 id="UsingVariablesinaQuery">Using Variables in a Query</h3>
<p>
The syntax for dynamic variables is simple, any upper case word beginning with '$' is considered a variable.
</p>
<p>
Example:
</p>
<div class="code"><pre><span class="k">SELECT</span> id <span class="k">AS</span> ticket<span class="p">,</span>summary <span class="k">FROM</span> ticket <span class="k">WHERE</span> priority<span class="o">=</span><span class="err">$</span>PRIORITY
</pre></div><p>
To assign a value to $PRIORITY when viewing the report, you must define it as an argument in the report URL, leaving out the leading '$':
</p>
<pre class="wiki"> http://trac.edgewall.org/reports/14?PRIORITY=high
</pre><p>
To use multiple variables, separate them with an '&amp;':
</p>
<pre class="wiki"> http://trac.edgewall.org/reports/14?PRIORITY=high&amp;SEVERITY=critical
</pre><h3 id="SpecialConstantVariables">Special/Constant Variables</h3>
<p>
There is one dynamic variable whose value is set automatically (the URL does not have to be changed) to allow practical reports. 
</p>
<ul><li>$USER — Username of logged in user.
</li></ul><p>
Example: List all tickets assigned to me:
</p>
<div class="code"><pre><span class="k">SELECT</span> id <span class="k">AS</span> ticket<span class="p">,</span>summary <span class="k">FROM</span> ticket <span class="k">WHERE</span> <span class="k">owner</span><span class="o">=</span><span class="err">$</span><span class="k">USER</span>
</pre></div><h2 id="AdvancedReports:CustomFormatting">Advanced Reports: Custom Formatting</h2>
<p>
Trac is also capable of more advanced reports, including custom layouts, result grouping and user-defined CSS styles. To create such reports, we will use specialized SQL statements to control the output of the Trac report engine.
</p>
<h3 id="SpecialColumns">Special Columns</h3>
<p>
To format reports, <a class="wiki" href="TracReports.html">TracReports</a> looks for 'magic' column names in the query result. These 'magic' names are processed and affect the layout and style of the final report.
</p>
<h3 id="Automaticallyformattedcolumns">Automatically formatted columns</h3>
<ul><li><strong>ticket</strong> — Ticket ID number. Becomes a hyperlink to that ticket. 
</li><li><strong>id</strong> — same as <strong>ticket</strong> above when <strong>realm</strong> is not set
</li><li><strong>realm</strong> — together with <strong>id</strong>, can be used to create links to other resources than tickets (e.g. a realm of <em>wiki</em> and an <em>id</em> to a page name will create a link to that wiki page)
<ul><li>for some kind of resources, it may be necessary to specify their <em>parent</em> resources (e.g. for <em>changeset</em>, which <em>repos</em>) and this can be achieved using the <strong>parent_realm</strong> and <strong>parent_id</strong> columns
</li></ul></li><li><strong>created, modified, date, time</strong> — Format cell as a date and/or time.
</li><li><strong>description</strong> — Ticket description field, parsed through the wiki engine.
</li></ul><p>
<strong>Example:</strong>
</p>
<div class="code"><pre><span class="k">SELECT</span> id <span class="k">AS</span> ticket<span class="p">,</span> created<span class="p">,</span> status<span class="p">,</span> summary <span class="k">FROM</span> ticket 
</pre></div><p>
Those columns can also be defined but marked as hidden, see <a class="wiki" href="TracReports.html#column-syntax">below</a>.
</p>
<p>
See <a class="ext-link" href="http://trac.edgewall.org/intertrac/wiki/CookBook/Configuration/Reports" title="wiki/CookBook/Configuration/Reports in Trac project trac"><span class="icon">​</span>trac:wiki/CookBook/Configuration/Reports</a> for some example of creating reports for realms other than <em>ticket</em>.
</p>
<h3 id="Customformattingcolumns">Custom formatting columns</h3>
<p>
Columns whose names begin and end with 2 underscores (Example: <strong><tt>__color__</tt></strong>) are
assumed to be <em>formatting hints</em>, affecting the appearance of the row.
 
</p>
<ul><li><strong><tt>__group__</tt></strong> — Group results based on values in this column. Each group will have its own header and table.
</li><li><strong><tt>__grouplink__</tt></strong> — Make the header of each group a link to the specified URL. The URL is taken from the first row of each group.
</li><li><strong><tt>__color__</tt></strong> — Should be a numeric value ranging from 1 to 5 to select a pre-defined row color. Typically used to color rows by issue priority.
<div style="margin-left:7.5em">Defaults:
<span style="border: none; color: #333; background: transparent; font-size: 85%; background: #fdc; border-color: #e88; color: #a22">Color 1</span>
<span style="border: none; color: #333; background: transparent; font-size: 85%; background: #ffb; border-color: #eea; color: #880">Color 2</span>
<span style="border: none; color: #333; background: transparent; font-size: 85%; background: #fbfbfb; border-color: #ddd; color: #444">Color 3</span>
<span style="border: none; color: #333; background: transparent; font-size: 85%; background: #e7ffff; border-color: #cee; color: #099">Color 4</span>
<span style="border: none; color: #333; background: transparent; font-size: 85%; background: #e7eeff; border-color: #cde; color: #469">Color 5</span>
</div>
</li><li><strong><tt>__style__</tt></strong> — A custom CSS style expression to use on the <tt>&lt;tr&gt;</tt> element of the current row.
</li><li><strong><tt>__class__</tt></strong> — Zero or more space-separated CSS class names to be set on the <tt>&lt;tr&gt;</tt> element of the current row. These classes are added to the class name derived from <tt>__color__</tt> and the odd / even indicator.
</li></ul><p>
<strong>Example:</strong> <em>List active tickets, grouped by milestone, group header linked to milestone page, colored by priority</em>
</p>
<div class="code"><pre><span class="k">SELECT</span> p<span class="p">.</span>value <span class="k">AS</span> __color__<span class="p">,</span>
     t<span class="p">.</span>milestone <span class="k">AS</span> __group__<span class="p">,</span>
     <span class="s1">'../milestone/'</span> <span class="o">||</span> t<span class="p">.</span>milestone <span class="k">AS</span> __grouplink__<span class="p">,</span>
     <span class="p">(</span><span class="k">CASE</span> <span class="k">owner</span> <span class="k">WHEN</span> <span class="s1">'daniel'</span> <span class="k">THEN</span> <span class="s1">'font-weight: bold; background: red;'</span> <span class="k">ELSE</span> <span class="s1">''</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> __style__<span class="p">,</span>
     t<span class="p">.</span>id <span class="k">AS</span> ticket<span class="p">,</span> summary
<span class="k">FROM</span> ticket t<span class="p">,</span>enum p
<span class="k">WHERE</span> t<span class="p">.</span>status <span class="k">IN</span> <span class="p">(</span><span class="s1">'new'</span><span class="p">,</span> <span class="s1">'assigned'</span><span class="p">,</span> <span class="s1">'reopened'</span><span class="p">)</span> 
  <span class="k">AND</span> p<span class="p">.</span>name <span class="o">=</span> t<span class="p">.</span>priority <span class="k">AND</span> p<span class="p">.</span><span class="k">type</span> <span class="o">=</span> <span class="s1">'priority'</span>
<span class="k">ORDER</span> <span class="k">BY</span> t<span class="p">.</span>milestone<span class="p">,</span> p<span class="p">.</span>value<span class="p">,</span> t<span class="p">.</span>severity<span class="p">,</span> t<span class="p">.</span>time
</pre></div><p>
<strong>Note:</strong> A table join is used to match <em>ticket</em> priorities with their numeric representation from the <em>enum</em> table.
</p>
<h3 id="column-syntax">Changing layout of report rows</h3>
<p>
By default, all columns on each row are display on a single row in the HTML report, possibly formatted according to the descriptions above. However, it is also possible to create multi-line report entries.
</p>
<ul><li><strong><tt>column_</tt></strong> — <em>Break row after this</em>. By appending an underscore ('_') to the column name, the remaining columns will be continued on a second line.
</li></ul><ul><li><strong><tt>_column_</tt></strong> — <em>Full row</em>. By adding an underscore ('_') both at the beginning and the end of a column name, the data will be shown on a separate row.
</li></ul><ul><li><strong><tt>_column</tt></strong> — <em>Hide data</em>. Prepending an underscore ('_') to a column name instructs Trac to hide the contents from the HTML output. This is useful for information to be visible only if downloaded in other formats (like CSV or RSS/XML).
This can be used to hide any kind of column, even important ones required for identifying the resource, e.g. <tt>id as _id</tt> will hide the <strong>Id</strong> column but the link to the ticket will be present.
</li></ul><p>
<strong>Example:</strong> <em>List active tickets, grouped by milestone, colored by priority, with  description and multi-line layout</em>
</p>
<div class="code"><pre><span class="k">SELECT</span> p<span class="p">.</span>value <span class="k">AS</span> __color__<span class="p">,</span>
       t<span class="p">.</span>milestone <span class="k">AS</span> __group__<span class="p">,</span>
       <span class="p">(</span><span class="k">CASE</span> <span class="k">owner</span> 
          <span class="k">WHEN</span> <span class="s1">'daniel'</span> <span class="k">THEN</span> <span class="s1">'font-weight: bold; background: red;'</span> 
          <span class="k">ELSE</span> <span class="s1">''</span> <span class="k">END</span><span class="p">)</span> <span class="k">AS</span> __style__<span class="p">,</span>
       t<span class="p">.</span>id <span class="k">AS</span> ticket<span class="p">,</span> summary <span class="k">AS</span> summary_<span class="p">,</span>             <span class="c1">-- ## Break line here
</span>       component<span class="p">,</span><span class="k">version</span><span class="p">,</span> severity<span class="p">,</span> milestone<span class="p">,</span> status<span class="p">,</span> <span class="k">owner</span><span class="p">,</span>
       time <span class="k">AS</span> created<span class="p">,</span> changetime <span class="k">AS</span> modified<span class="p">,</span>         <span class="c1">-- ## Dates are formatted
</span>       description <span class="k">AS</span> _description_<span class="p">,</span>                    <span class="c1">-- ## Uses a full row
</span>       changetime <span class="k">AS</span> _changetime<span class="p">,</span> reporter <span class="k">AS</span> _reporter <span class="c1">-- ## Hidden from HTML output
</span><span class="k">FROM</span> ticket t<span class="p">,</span>enum p
<span class="k">WHERE</span> t<span class="p">.</span>status <span class="k">IN</span> <span class="p">(</span><span class="s1">'new'</span><span class="p">,</span> <span class="s1">'assigned'</span><span class="p">,</span> <span class="s1">'reopened'</span><span class="p">)</span> 
  <span class="k">AND</span> p<span class="p">.</span>name <span class="o">=</span> t<span class="p">.</span>priority <span class="k">AND</span> p<span class="p">.</span><span class="k">type</span> <span class="o">=</span> <span class="s1">'priority'</span>
<span class="k">ORDER</span> <span class="k">BY</span> t<span class="p">.</span>milestone<span class="p">,</span> p<span class="p">.</span>value<span class="p">,</span> t<span class="p">.</span>severity<span class="p">,</span> t<span class="p">.</span>time
</pre></div><h3 id="Reportingoncustomfields">Reporting on custom fields</h3>
<p>
If you have added custom fields to your tickets (see <a class="wiki" href="http://kahina.org/trac/wiki/TracTicketsCustomFields">TracTicketsCustomFields</a>), you can write a SQL query to cover them. You'll need to make a join on the ticket_custom table, but this isn't especially easy.
</p>
<p>
If you have tickets in the database <em>before</em> you declare the extra fields in trac.ini, there will be no associated data in the ticket_custom table. To get around this, use SQL's "LEFT OUTER JOIN" clauses. See <a class="ext-link" href="http://trac.edgewall.org/intertrac/TracIniReportCustomFieldSample" title="TracIniReportCustomFieldSample in Trac project trac"><span class="icon">​</span>TracIniReportCustomFieldSample</a> for some examples.
</p>
<h3 id="rewriting">A note about SQL rewriting</h3>
<p>
Beyond the relatively trivial replacement of dynamic variables, the SQL query is also altered in order to support two features of the reports:
</p>
<ol><li><a class="wiki" href="TracReports.html#sort-order">changing the sort order</a>
</li><li>pagination support (limitation of the number of result rows displayed on each page)
</li></ol><p>
In order to support the first feature, the sort column is inserted in the <tt>ORDER BY</tt> clause in the first position or in the second position if a <tt>__group__</tt> column is specified (an <tt>ORDER BY</tt> clause is created if needed). In order to support pagination, a <tt>LIMIT ... OFFSET ...</tt> clause is appended.
The query might be too complex for the automatic rewrite to work correctly, resulting in an erroneous query. In this case you still have the possibility to control exactly how the rewrite is done by manually inserting the following tokens:
</p>
<ul><li><tt>@SORT_COLUMN@</tt>, the place where the name of the selected sort column will be inserted,
</li><li><tt>@LIMIT_OFFSET@</tt>, the place where the pagination support clause will be added
</li></ul><p>
Note that if you write them after an SQL comment, <tt>--</tt>, you'll effectively disable rewriting if this is what you want!
</p>
<p>
Let's take an example, consider the following SQL query:
</p>
<div class="code"><pre><span class="c1">-- ## 4: Assigned, Active Tickets by Owner ## --
</span>
<span class="c1">-- 
-- List assigned tickets, group by ticket owner, sorted by priority.
-- 
</span>
<span class="k">SELECT</span> p<span class="p">.</span>value <span class="k">AS</span> __color__<span class="p">,</span>
   <span class="k">owner</span> <span class="k">AS</span> __group__<span class="p">,</span>
   id <span class="k">AS</span> ticket<span class="p">,</span> summary<span class="p">,</span> component<span class="p">,</span> milestone<span class="p">,</span> t<span class="p">.</span><span class="k">type</span> <span class="k">AS</span> <span class="k">type</span><span class="p">,</span> severity<span class="p">,</span> time <span class="k">AS</span> created<span class="p">,</span>
   changetime <span class="k">AS</span> _changetime<span class="p">,</span> description <span class="k">AS</span> _description<span class="p">,</span>
   reporter <span class="k">AS</span> _reporter
<span class="k">FROM</span> ticket t<span class="p">,</span>enum p
<span class="k">WHERE</span> status <span class="o">=</span> <span class="s1">'assigned'</span>
  <span class="k">AND</span> p<span class="p">.</span>name <span class="o">=</span> t<span class="p">.</span>priority <span class="k">AND</span> p<span class="p">.</span><span class="k">type</span> <span class="o">=</span> <span class="s1">'priority'</span>
<span class="k">ORDER</span> <span class="k">BY</span> __group__<span class="p">,</span> p<span class="p">.</span>value<span class="p">,</span> severity<span class="p">,</span> time
</pre></div><p>
The automatic rewrite will be the following (4 rows per page, page 2, sorted by <tt>component</tt>):
</p>
<div class="code"><pre><span class="k">SELECT</span> p<span class="p">.</span>value <span class="k">AS</span> __color__<span class="p">,</span>
   <span class="k">owner</span> <span class="k">AS</span> __group__<span class="p">,</span>
   id <span class="k">AS</span> ticket<span class="p">,</span> summary<span class="p">,</span> component<span class="p">,</span> milestone<span class="p">,</span> t<span class="p">.</span><span class="k">type</span> <span class="k">AS</span> <span class="k">type</span><span class="p">,</span> severity<span class="p">,</span> time <span class="k">AS</span> created<span class="p">,</span>
   changetime <span class="k">AS</span> _changetime<span class="p">,</span> description <span class="k">AS</span> _description<span class="p">,</span>
   reporter <span class="k">AS</span> _reporter
<span class="k">FROM</span> ticket t<span class="p">,</span>enum p
<span class="k">WHERE</span> status <span class="o">=</span> <span class="s1">'assigned'</span>
  <span class="k">AND</span> p<span class="p">.</span>name <span class="o">=</span> t<span class="p">.</span>priority <span class="k">AND</span> p<span class="p">.</span><span class="k">type</span> <span class="o">=</span> <span class="s1">'priority'</span>
<span class="k">ORDER</span> <span class="k">BY</span> __group__ <span class="k">ASC</span><span class="p">,</span> <span class="o">`</span>component<span class="o">`</span> <span class="k">ASC</span><span class="p">,</span>  __group__<span class="p">,</span> p<span class="p">.</span>value<span class="p">,</span> severity<span class="p">,</span> time
<span class="k">LIMIT</span> <span class="mi">4</span> <span class="k">OFFSET</span> <span class="mi">4</span>
</pre></div><p>
The equivalent SQL query with the rewrite tokens would have been:
</p>
<div class="code"><pre><span class="k">SELECT</span> p<span class="p">.</span>value <span class="k">AS</span> __color__<span class="p">,</span>
   <span class="k">owner</span> <span class="k">AS</span> __group__<span class="p">,</span>
   id <span class="k">AS</span> ticket<span class="p">,</span> summary<span class="p">,</span> component<span class="p">,</span> milestone<span class="p">,</span> t<span class="p">.</span><span class="k">type</span> <span class="k">AS</span> <span class="k">type</span><span class="p">,</span> severity<span class="p">,</span> time <span class="k">AS</span> created<span class="p">,</span>
   changetime <span class="k">AS</span> _changetime<span class="p">,</span> description <span class="k">AS</span> _description<span class="p">,</span>
   reporter <span class="k">AS</span> _reporter
<span class="k">FROM</span> ticket t<span class="p">,</span>enum p
<span class="k">WHERE</span> status <span class="o">=</span> <span class="s1">'assigned'</span>
  <span class="k">AND</span> p<span class="p">.</span>name <span class="o">=</span> t<span class="p">.</span>priority <span class="k">AND</span> p<span class="p">.</span><span class="k">type</span> <span class="o">=</span> <span class="s1">'priority'</span>
<span class="k">ORDER</span> <span class="k">BY</span> __group__<span class="p">,</span> <span class="o">@</span>SORT_COLUMN<span class="o">@</span><span class="p">,</span> p<span class="p">.</span>value<span class="p">,</span> severity<span class="p">,</span> time
<span class="o">@</span>LIMIT_OFFSET<span class="o">@</span>
</pre></div><p>
If you want to always sort first by priority and only then by the user selected sort column, simply use the following <tt>ORDER BY</tt> clause:
</p>
<div class="code"><pre><span class="k">ORDER</span> <span class="k">BY</span> __group__<span class="p">,</span> p<span class="p">.</span>value<span class="p">,</span> <span class="o">@</span>SORT_COLUMN<span class="o">@</span><span class="p">,</span> severity<span class="p">,</span> time
</pre></div><hr />
<p>
See also: <a class="wiki" href="TracTickets.html">TracTickets</a>, <a class="wiki" href="TracQuery.html">TracQuery</a>, <a class="wiki" href="TracGuide.html">TracGuide</a>, <a class="ext-link" href="http://www.sqlite.org/lang_expr.html"><span class="icon">​</span>Query Language Understood by SQLite</a>
</p>
</div>
          
          <div class="trac-modifiedby">
            <span><a href="http://kahina.org/trac/wiki/TracReports?action=diff&amp;version=5" title="Version 5 by trac">Last modified</a> <a class="timeline" href="http://kahina.org/trac/timeline?from=2017-12-09T21%3A10%3A36%2B01%3A00&amp;precision=second" title="See timeline at Dec 9, 2017, 9:10:36 PM">14 months ago</a></span>
            <span class="trac-print">Last modified on Dec 9, 2017, 9:10:36 PM</span>
          </div>
        
        
      </div>
      

    </div>
    <script type="text/javascript">
        jQuery.loadStyleSheet("/trac/pygments/trac.css", "text/css");
    </script>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="last first">
          <a rel="nofollow" href="http://kahina.org/trac/wiki/TracReports?format=txt">Plain Text</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="../chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Powered by <a href="../about.html"><strong>Trac 1.0.9</strong></a><br />
        By <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right">Visit the Trac open source project at<br /><a href="http://trac.edgewall.org/">http://trac.edgewall.org/</a></p>
    </div>
  </body>
</html>